import{d as M,B as S,c as d,j as n,a as t,w as a,b as s,r as v,H as _,o as u,f as c,t as r,h as m,F as y,I as k,k as p}from"./index-DdbpnQh1.js";import{g as I,_ as g}from"./createLucideIcon-DfyR5A8Z.js";import{_ as w}from"./ScrollArea.vue_vue_type_script_setup_true_lang-BfiZ6toR.js";import{_ as C,a as R,b as $}from"./index-Bevz_C_5.js";import{_ as L,d as O,e as b,f as j,X as A}from"./TabsTrigger.vue_vue_type_script_setup_true_lang-BsCY6Tvh.js";const B=I("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),T={class:"flex h-full w-full flex-col p-6"},D={key:0,class:"ml-2 bg-red-500 text-white text-[10px] px-1.5 rounded-full"},E={key:0,class:"ml-2 bg-red-500 text-white text-[10px] px-1.5 rounded-full"},H={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},U={class:"font-medium"},X={class:"text-sm text-muted-foreground"},J={key:0,class:"col-span-full text-center text-muted-foreground py-10"},K={class:"space-y-4"},P={class:"flex items-center gap-4"},Q={class:"font-medium"},W={class:"text-sm text-muted-foreground"},Y={class:"text-xs text-muted-foreground"},Z={key:0,class:"flex gap-2"},ee={key:1,class:"text-sm text-muted-foreground"},te={key:0,class:"text-center text-muted-foreground py-10"},se={class:"space-y-4"},le={class:"flex items-center gap-4"},ae={class:"font-medium"},ne={class:"text-sm text-muted-foreground"},oe={class:"text-xs text-muted-foreground"},de={key:0,class:"flex gap-2"},ue={key:1,class:"text-sm text-muted-foreground"},re={key:0,class:"text-center text-muted-foreground py-10"},pe=M({__name:"Contacts",setup(ce){const F=v("friends"),x=v([]),i=v([]),f=v([]),N=async()=>{try{const o=await _.get("/friend/list");x.value=o||[]}catch(o){console.error(o)}},V=async()=>{try{const o=await _.get("/friend/requests");i.value=o||[]}catch(o){console.error(o)}},q=async()=>{try{const o=await _.get("/group/requests");f.value=o||[]}catch(o){console.error(o)}},G=async(o,l)=>{try{await _.post("/friend/handle",{request_id:o,action:l}),p.success(l===1?"Friend request accepted":"Friend request rejected"),V(),N(),useChatStore().fetchRequestCounts()}catch(e){p.error(e.message)}},z=async(o,l)=>{try{await _.post("/group/handle-join",{request_id:o,action:l}),p.success(l===1?"Group request accepted":"Group request rejected"),q(),useChatStore().fetchRequestCounts()}catch(e){p.error(e.message)}};return S(()=>{N(),V(),q()}),(o,l)=>(u(),d("div",T,[l[8]||(l[8]=n("h1",{class:"text-2xl font-bold mb-6"},"Contacts",-1)),t(s(L),{modelValue:F.value,"onUpdate:modelValue":l[0]||(l[0]=e=>F.value=e),class:"w-full flex-1 flex flex-col"},{default:a(()=>[t(s(O),null,{default:a(()=>[t(s(b),{value:"friends"},{default:a(()=>[...l[1]||(l[1]=[c("My Friends",-1)])]),_:1}),t(s(b),{value:"friend-requests"},{default:a(()=>[l[2]||(l[2]=c(" Friend Requests ",-1)),i.value.length?(u(),d("span",D,r(i.value.length),1)):m("",!0)]),_:1}),t(s(b),{value:"group-requests"},{default:a(()=>[l[3]||(l[3]=c(" Group Requests ",-1)),f.value.length?(u(),d("span",E,r(f.value.length),1)):m("",!0)]),_:1})]),_:1}),t(s(j),{value:"friends",class:"flex-1 mt-4"},{default:a(()=>[t(s(w),{class:"h-full"},{default:a(()=>[n("div",H,[(u(!0),d(y,null,k(x.value,e=>(u(),d("div",{key:e.id,class:"flex items-center gap-4 p-4 border rounded-lg"},[t(s(C),null,{default:a(()=>[t(s(R),{src:e.avatar},null,8,["src"]),t(s($),null,{default:a(()=>[c(r(e.nickname?.slice(0,2)||e.username.slice(0,2)),1)]),_:2},1024)]),_:2},1024),n("div",null,[n("div",U,r(e.nickname||e.username),1),n("div",X,r(e.online?"Online":"Offline"),1)])]))),128)),x.value.length===0?(u(),d("div",J," No friends yet ")):m("",!0)])]),_:1})]),_:1}),t(s(j),{value:"friend-requests",class:"flex-1 mt-4"},{default:a(()=>[t(s(w),{class:"h-full"},{default:a(()=>[n("div",K,[(u(!0),d(y,null,k(i.value,e=>(u(),d("div",{key:e.id,class:"flex items-center justify-between p-4 border rounded-lg"},[n("div",P,[t(s(C),null,{default:a(()=>[t(s(R),{src:e.avatar},null,8,["src"]),t(s($),null,{default:a(()=>[c(r(e.sender_name?.slice(0,2)),1)]),_:2},1024)]),_:2},1024),n("div",null,[n("div",Q,r(e.sender_name),1),n("div",W,r(e.remark||"No remark"),1),n("div",Y,r(e.created_at),1)])]),e.status===0?(u(),d("div",Z,[t(s(g),{size:"sm",variant:"outline",onClick:h=>G(e.id,2)},{default:a(()=>[t(s(A),{class:"w-4 h-4 mr-1"}),l[4]||(l[4]=c(" Reject ",-1))]),_:1},8,["onClick"]),t(s(g),{size:"sm",onClick:h=>G(e.id,1)},{default:a(()=>[t(s(B),{class:"w-4 h-4 mr-1"}),l[5]||(l[5]=c(" Accept ",-1))]),_:1},8,["onClick"])])):(u(),d("div",ee,r(e.status===1?"Accepted":"Rejected"),1))]))),128)),i.value.length===0?(u(),d("div",te," No pending friend requests ")):m("",!0)])]),_:1})]),_:1}),t(s(j),{value:"group-requests",class:"flex-1 mt-4"},{default:a(()=>[t(s(w),{class:"h-full"},{default:a(()=>[n("div",se,[(u(!0),d(y,null,k(f.value,e=>(u(),d("div",{key:e.id,class:"flex items-center justify-between p-4 border rounded-lg"},[n("div",le,[t(s(C),null,{default:a(()=>[t(s(R),{src:e.avatar},null,8,["src"]),t(s($),null,{default:a(()=>[c(r(e.sender_name?.slice(0,2)),1)]),_:2},1024)]),_:2},1024),n("div",null,[n("div",ae,r(e.sender_name)+" wants to join "+r(e.group_name),1),n("div",ne,r(e.remark||"No remark"),1),n("div",oe,r(e.created_at),1)])]),e.status===0?(u(),d("div",de,[t(s(g),{size:"sm",variant:"outline",onClick:h=>z(e.id,2)},{default:a(()=>[t(s(A),{class:"w-4 h-4 mr-1"}),l[6]||(l[6]=c(" Reject ",-1))]),_:1},8,["onClick"]),t(s(g),{size:"sm",onClick:h=>z(e.id,1)},{default:a(()=>[t(s(B),{class:"w-4 h-4 mr-1"}),l[7]||(l[7]=c(" Accept ",-1))]),_:1},8,["onClick"])])):(u(),d("div",ue,r(e.status===1?"Accepted":"Rejected"),1))]))),128)),f.value.length===0?(u(),d("div",re," No pending group requests ")):m("",!0)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}});export{pe as default};
